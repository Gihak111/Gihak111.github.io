---
layout: single
title:  "스트랭글러 패턴: 단계적 시스템 전환의 전략"
categories: "Architecture_Patterns"
tag: "code"
toc: true
author_profile: false
sidebar:
    nav: "docs"
---

# 스트랭글러 패턴: 단계적 시스템 전환의 전략

**스트랭글러 패턴(Strangler Fig Pattern)**은 기존 시스템을 새로운 시스템으로 점진적으로 대체하기 위한 소프트웨어 아키텍처 패턴이다.  
이 패턴은 기존 시스템의 전면적인 교체 대신, 기능별로 점진적인 대체를 통해 **리스크를 최소화**하고, **운영 중단**을 방지하며, **이전 과정을 유연하게 관리**하는 데 초점을 맞춘다.

---

## 스트랭글러 패턴의 기원

### 명칭의 유래
이 패턴의 이름은 **'스트랭글러 무화과 나무'**에서 유래되었다.  
이 나무는 기존의 나무를 감싸고 뿌리를 내려 서서히 기존 나무를 대체하는 자연적 과정을 통해 성장한다.  
스트랭글러 패턴도 이와 비슷하게, 기존 시스템을 감싸면서 새 시스템으로 기능을 하나씩 대체하는 방식을 따른다.

---

## 스트랭글러 패턴의 핵심 개념

1. **기존 시스템 유지**:
   - 기존 시스템(모놀리식 또는 레거시)은 초기 단계에서 여전히 동작하며 사용 가능.
   
2. **기능 단위 전환**:
   - 기존 시스템의 일부 기능을 새로운 시스템으로 대체.
   - 이 과정에서 점진적으로 새 시스템의 영역이 확장.

3. **리버스 프록시 사용**:
   - 사용자 요청을 기존 시스템과 새 시스템으로 분기 처리하여 두 시스템이 동시에 작동할 수 있도록 조정.

4. **완전 전환 후 기존 시스템 종료**:
   - 새 시스템이 모든 기능을 맡게 되면, 기존 시스템은 안전하게 종료.

---

## 스트랭글러 패턴의 동작 구조

### 1. 기존 시스템의 식별
- 기존 시스템의 **기능 구성 요소**와 **종속성**을 분석.
- 시스템의 주요 문제점을 파악(성능 저하, 유지보수 어려움 등).

### 2. 리버스 프록시 설정
- 사용자 요청을 가로채고, 이를 기존 시스템 또는 새 시스템으로 분기.
- 기존과 새로운 시스템의 **통합적 동작**을 보장.

### 3. 새로운 기능의 단계적 구현
- 기존 시스템에서 제공하는 기능을 **단계적으로 새 시스템으로 이전**.
- 각 기능의 테스트를 통해 안정성을 확보.

### 4. 기존 시스템의 단계적 폐기
- 새로운 시스템이 모든 기능을 맡을 때, 기존 시스템을 완전히 종료.

---

## 스트랭글러 패턴의 구현 예시

### 예: 기존 모놀리식 시스템에서 마이크로서비스로 전환

#### 1. 리버스 프록시 구성
```yaml
# NGINX 리버스 프록시 설정
server {
    listen 80;
    
    location /api/v1/new-feature {
        proxy_pass http://new-system;  # 새로운 시스템으로 라우팅
    }

    location / {
        proxy_pass http://legacy-system;  # 기존 시스템으로 라우팅
    }
}
```

#### 2. 새로운 기능 개발
```python
# 기존 시스템의 일부 기능을 마이크로서비스로 전환
from flask import Flask, jsonify

app = Flask(__name__)

@app.route('/api/v1/new-feature', methods=['GET'])
def new_feature():
    return jsonify({"message": "This is a new feature!"})
```

#### 3. 테스트 및 전환
- 새로운 기능이 기존 기능과 동일한 출력을 제공하는지 테스트.
- 리버스 프록시 설정을 업데이트하여 더 많은 요청을 새 시스템으로 라우팅.

---

## 스트랭글러 패턴의 장점

1. **운영 중단 최소화**:
   - 시스템 전체를 한 번에 전환하지 않아 **서비스 가용성** 유지.
2. **리스크 관리**:
   - 새로운 기능을 점진적으로 배포하여 문제가 발생한 경우 복구 용이.
3. **점진적 전환**:
   - 전환 속도를 조정할 수 있어 **비즈니스 요구**와 **리소스 가용성**에 맞춤 가능.
4. **유연성**:
   - 새로운 기술을 기존 시스템에 점진적으로 통합 가능.

---

## 스트랭글러 패턴의 한계

1. **복잡성 증가**:
   - 두 시스템이 병행 운영되기 때문에 **운영 및 유지보수 복잡성**이 증가.
2. **긴 전환 기간**:
   - 점진적 전환은 시간이 오래 걸릴 수 있음.
3. **리소스 중복 사용**:
   - 기존과 새로운 시스템이 동시에 작동하기 때문에 추가적인 리소스 요구.

---

## 사용 사례

### 1. 모놀리식에서 마이크로서비스로 전환
- 레거시 애플리케이션의 각 기능을 독립적인 마이크로서비스로 분리.

### 2. 클라우드 마이그레이션
- 온프레미스 환경에서 클라우드로 데이터 및 애플리케이션을 점진적으로 이전.

### 3. 새로운 기술 도입
- 기존 시스템에서 새로운 기술 스택을 점진적으로 통합.

---

## 구현 사례: 실제 적용 시나리오

### 시나리오: 전자상거래 시스템의 전환
1. **기존 시스템**:
   - 사용자가 쇼핑 카트 기능을 포함한 모든 기능을 단일 시스템에서 이용.
2. **리버스 프록시 설정**:
   - `/cart` 요청은 새로운 마이크로서비스로 라우팅.
3. **새 시스템 확장**:
   - 점진적으로 검색, 결제, 사용자 관리 등의 기능도 새로운 시스템으로 이전.
4. **완전 전환**:
   - 기존 시스템 종료 후, 새 시스템만 운영.

---

## 결론

스트랭글러 패턴은 기존 시스템을 안전하고 유연하게 새로운 시스템으로 전환할 수 있는 강력한 도구이다.  
이 패턴은 운영 중단을 방지하고, 점진적인 전환 과정을 통해 리스크를 최소화하며, **비즈니스 연속성**을 유지하는 데 최적화되어 있다.

스트랭글러 패턴을 효과적으로 활용하려면, **철저한 계획**과 **세부적인 테스트**가 필수적이다.  
이를 통해 기존 시스템의 문제를 해결하고 새로운 시스템의 가능성을 최대한 활용할 수 있다.